<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BTS – Cahier des charges (Phase 1)</title>
<style>
:root{
  --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#94a3b8; --border:#1f2937;
  --accent:#22d3ee; --ok:#34d399; --warn:#fbbf24; --danger:#f87171;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:#0b1020;color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
a{color:var(--accent);text-decoration:none}
.container{max-width:1100px;margin:0 auto;padding:24px}
header{position:sticky;top:0;background:rgba(17,24,39,.9);border-bottom:1px solid var(--border);backdrop-filter:saturate(140%) blur(6px);}
header .inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:14px;padding:12px 24px}
header img{height:38px}
h1{font-size:28px;margin:18px 0 8px}
h2{font-size:22px;margin:20px 0 8px}
h3{font-size:18px;margin:18px 0 6px}
p{margin:8px 0}
ul{margin:6px 0 12px 22px}
code,kbd,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,"Courier New",monospace}
pre{background:#0b1020;border:1px solid var(--border);border-radius:8px;padding:12px;overflow:auto;white-space:pre}
table{width:100%;border-collapse:collapse;margin:10px 0 16px}
th,td{border:1px solid var(--border);padding:8px;vertical-align:top}
.small{color:var(--muted);font-size:12px}
.card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:18px;margin:16px 0}
footer{border-top:1px solid var(--border);margin-top:24px;padding:16px 24px;color:var(--muted)}
.toc{background:#0b1020;border:1px solid var(--border);border-radius:12px;padding:12px}
hr{border:none;border-top:1px solid var(--border);margin:16px 0}
</style>
</head>
<body>
<header><div class="inner">
  <img src="logo.png" alt="Belougas" />
  <div>
    <div class="small">BelougasTicketingSystem · Phase 1 · 2025-08-17</div>
    <strong>BTS – Cahier des charges (Phase 1)</strong>
  </div>
</div></header>
<main class="container">

<div class="card">
  <h1>Cahier des charges – Phase 1 (Renew)</h1>
  <p><strong>Projet</strong> : BelougasTicketingSystem (BTS) – Club de hockey Belougas<br/>
     <strong>Date</strong> : 2025-08-17<br/>
     <strong>Licence</strong> : MIT</p>
</div>

<h2>1. Contexte &amp; objectifs</h2>
<ul>
  <li>Billetterie auto-hébergée (OVH VPS), open source, Node.js/Express + MongoDB.</li>
  <li>Intégration paiement via HelloAsso CheckOut (sandbox en INT, production en PROD).</li>
  <li>Phase 1 centrée sur les <strong>renouvellements</strong> d’abonnements existants (sans QR-code).</li>
  <li>Front léger (HTML/CSS/JS statiques), intégrable dans WordPress via iframe.</li>
</ul>

<h2>2. Périmètre fonctionnel Phase 1</h2>
<h3>2.1 Renouvellements (scénario 1)</h3>
<ul>
  <li>Lien personnalisé (token) envoyé aux abonnés N-1.</li>
  <li>Affichage plan SVG (venue) avec surbrillance des sièges à renouveler.</li>
  <li>Choix du tarif par siège, justificatifs, paiement 1/2/3 fois.</li>
  <li>Attestation e-mail après paiement validé (pas de QR-code en Phase 1).</li>
</ul>
<h3>2.2 Provision & synchronisation</h3>
<ul>
  <li>Sièges N-1 marqués <em>provisioned</em> (non réservable public), visibles sur le plan.</li>
  <li>À clôture administrateur, sièges non renouvelés → <em>available</em> (phase publique).</li>
</ul>
<h3>2.3 Administration (extraits)</h3>
<ul>
  <li>Import/export abonnés (CSV <em>flat</em> 1 ligne = 1 siège), catalogue tarifs, prix par zone.</li>
  <li>Gestion des saisons (code, venueSlug, phases).</li>
  <li>E-mails : test SMTP, invitations renew (bulk), attestation post-paiement.</li>
</ul>

<h2>3. Contraintes &amp; exigences</h2>
<ul>
  <li>Node ≥ 20, Mongo ≥ 6, Nginx, PM2, Ubuntu 22.04.</li>
  <li>Sécurité : ENV séparés DEV/INT/PROD, auth Mongo, .env, HTTPS, CORS, rate-limit.</li>
  <li>Interop : HelloAsso sandbox/prod, e-mail Gmail (mot de passe application).</li>
  <li>UX : responsive, tarifs dynamiques (prix & justificatifs).</li>
  <li>Perf : CSV, indexes, TTL sur réservations (<code>SeatHold</code>).</li>
</ul>

<h2>4. Hors périmètre</h2>
<ul>
  <li>Vente publique complète, TBH7 si non finalisé, QR-code par match, multi-événements avancés, reporting BI.</li>
</ul>

<h2>5. KPI</h2>
<ul>
  <li>Taux de renouvellement, paiements confirmés, erreurs paiement, délivrabilité e-mail.</li>
</ul>

<h2>6. Dépôt</h2>
<p>Dépôt GitHub public <code>belou00/bts</code> – branches : <code>main</code> (PROD), <code>int</code> (INT), <code>dev</code> (DEV).</p>
</main>
<footer>
  <div>Licence MIT · © TBHC / Belougas</div>
</footer>
</body></html>